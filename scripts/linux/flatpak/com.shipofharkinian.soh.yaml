id: com.shipofharkinian.soh
command: "soh.sh"
desktop-file-name-suffix: " (Nightly)"
finish-args: 
  - --share=ipc
  - --socket=fallback-x11
  - --socket=x11
  - --nosocket=wayland
  - --socket=pulseaudio
  - --share=network
  - --filesystem=home
  - --device=all
modules: 
  - "modules/glew/glew.json"
  - "modules/glfw/glfw.json"
  - "modules/glu/glu-9.json"
  - "modules/ImageMagick/ImageMagick.json"
  - name: "soh"
    buildsystem: "simple"
    build-commands:
    - cmake -H. -Bbuild -GNinja -DCMAKE_BUILD_TYPE=Release -DCMAKE_PREFIX_PATH=/app
    - cmake --build build --config Release --target ExtractAssets
    - cmake --build build --config Release --target OTRGui
    - cmake --build build --config Release
    - cmake --install build --config Release --prefix ${FLATPAK_DEST}/bin
    - mkdir ${FLATPAK_DEST}/share/applications
    - cp scripts/linux/appimage/soh.desktop ${FLATPAK_DEST}/share/applications
    - mkdir ${FLATPAK_DEST}/share/metainfo
    - cp scripts/linux/flatpak/${FLATPAK_ID}.metainfo.xml /app/share/metainfo/${FLATPAK_ID}.metainfo.xml
    build-options: 
      build-args: 
        - --share=network
    sources: 
    - type: dir
      path: "../../.."

rename-desktop-file: soh.desktop
rename-icon: sohIcon
runtime: "org.freedesktop.Platform"
runtime-version: "22.08"
sdk: "org.freedesktop.Sdk"
default-branch: "stable"
